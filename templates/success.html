<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
  
  <link rel="stylesheet" type="text/css" href='static/main.css'>
    <title>Album Successfully Created</title>
</head>
<body>
<h1>Your album has been created!</h1>
<p> You can now see your playlist in your Spotify account. </p>
<h3> External Link: </h3>
    <ul>
        <li> <a href="https://open.spotify.com/playlist/{{playlist_id}}"> View Playlist <img src="img/spotify_icon.jpg"/> </a> </li>
    </ul>
    <script>
        document.querySelector("form").onsubmit = function(e) {

            //e.preventDefault();

            let formData = new FormData();
            let artist = document.querySelector("input[name=artist]").value;
            let username = document.querySelector("input[name=username]").value;
            let playlist = document.querySelector("input[name=playlist]").value;

            formData.append("artist", artist);
            formData.append("username", username);
            formData.append("playlist", playlist);
            fetch("/spotify-generator", {
                method: "POST",
                body: formData
            })
            .then(function(response) {
                // This right here is the response we will receive before we convert
                // it over to readable JSON
                console.log("Response turning to readable JSON", response);
                return response.json();
            })
            .then(function(response) {
                // Don't worry if this says "false", it just returns that when the user already exists from flasks end
                // Once it reaches here, the async is already successful
                console.log("Successful async: ");
                //redirect to success page

            })
            .catch(function(error) {
                console.log("Error in async", error);
            });
        }
    </script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
</body>
</html>