<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Rajdhani:wght@300&display=swap');
        @import url('https://db.onlinewebfonts.com/c/01173b246d9d9ea808ea75a26b3b61bb?family=CircularSpotifyTxT-Black');
    </style>
    <link rel="stylesheet" type="text/css" href='static/main.css'>
    <title>Album Successfully Created</title>
</head>
<body class="left-right-margin">
  {% extends 'base.html' %}

  {% block title %}Success{% endblock %}
  {% block content %}
<br>
<h1>Your album has been created!</h1>
<h2 class="inc250"> You can now see your playlist in your Spotify account. </h2>
<a class="inc250" href="https://open.spotify.com/playlist/{{playlist_id}}"> View Playlist in Spotify <img src="img\spotifyLogo.png"> </a><br>
<a class="btn btn-primary inc250 but top-bottom-margin" href="/spotify-generator">Generate Another Playlist</a>
    <script>
        document.querySelector("form").onsubmit = function(e) {

            //e.preventDefault();

            let formData = new FormData();
            let artist = document.querySelector("input[name=artist]").value;
            let username = document.querySelector("input[name=username]").value;
            let playlist = document.querySelector("input[name=playlist]").value;

            formData.append("artist", artist);
            formData.append("username", username);
            formData.append("playlist", playlist);
            fetch("/spotify-generator", {
                method: "POST",
                body: formData
            })
            .then(function(response) {
                // This right here is the response we will receive before we convert
                // it over to readable JSON
                console.log("Response turning to readable JSON", response);
                return response.json();
            })
            .then(function(response) {
                // Don't worry if this says "false", it just returns that when the user already exists from flasks end
                // Once it reaches here, the async is already successful
                console.log("Successful async: ");
                //redirect to success page

            })
            .catch(function(error) {
                console.log("Error in async", error);
            });
        }
    </script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
{% for track_id in track_ids %}
    <iframe class="test3" style="border-radius:12px" src="https://open.spotify.com/embed/track/{{ track_id }}?utm_source=generator" width="100%" height="80" frameBorder="0" allowfullscreen="" allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture" loading="lazy"></iframe>
{% endfor %}
<br>
<br>
{% endblock %}
</body>
</html>